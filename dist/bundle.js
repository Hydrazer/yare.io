(()=>{var u=Math.pow;function r(i,t){return u(i[0]-t[0],2)+u(i[1]-t[1],2)}function D(i,t){return[i[0]-t[0],i[1]-t[1]]}function E(i,t){return[i[0]/t,i[1]/t]}function l(i,t,o){let _=D(i,t),n=Math.sqrt(u(_[0],2)+u(_[1],2)),m=E(_,n),g=[Math.floor(m[0]*o),Math.floor(m[1]*o)];return[g[0]+t[0],g[1]+t[1]]}function h(i,t){let o=r(spirits[i[0]].position,t),_=spirits[i[0]];for(let n of i){let m=r(spirits[n].position,t);m<o&&(o=m,_=spirits[n])}return _}function w(i,t){let o=r(i[0].position,t),_=i[0];for(let n of i){let m=r(n.position,t);m<o&&(o=m,_=n)}return _}function A(i,t){let o=1e3,_="NONE";for(let n of i)n.energy<o&&n.energy<n.energy_capacity&&memory[n.id]==t&&(o=n.energy,_=n);return _}function q(i){let t=0;for(let o of i)t+=spirits[o].energy;return t}{r(base.position,star_zxq.position)<r(base.position,star_a1c.position)?(memory.base_star=star_zxq,memory.enemy_star=star_a1c):(memory.base_star=star_a1c,memory.enemy_star=star_zxq),all_spirits=[];for(x of Object.keys(spirits))all_spirits.push(spirits[x]);enemy_spirits=all_spirits.filter(a=>a.hp==1).filter(a=>a.player_id!="saltAxAtlas"),friendly_spirits=all_spirits.filter(a=>a.hp==1).filter(a=>a.player_id=="saltAxAtlas");let i=friendly_spirits.length,t=outpost.control,o=l(outpost.position,star_p89.position,199),_=l(memory.base_star.position,base.position,190),n=l(memory.base_star.position,_,180),m=l(memory.base_star.position,n,150),g=l(outpost.position,base.position,70),O=l(star_p89.position,enemy_base.position,300),N=l(enemy_base.position,star_p89.position,199),b=0;if(enemy_spirits.length==0&&(b=1),b==0){let a=1,d=2,M=12,B=5;t!="saltAxAtlas"&&t!=""&&(a=0,d=0);let f=Math.floor((i-a-d)/3);f>3&&(f=3);let v=f,z=f,k=f*2;for(let e of friendly_spirits)if(a)memory[e.id]=="outpost_harvesting"&&e.energy!=e.energy_capacity?memory[e.id]="outpost_harvesting":e.energy>10?memory[e.id]="harasser":memory[e.id]="outpost_harvesting",a-=1;else if(d)(memory[e.id]=="base_defender"||memory[e.id]=="base_charging"||memory[e.id]=="base_harvesting")&&(memory[e.id]="outpost_harvesting"),outpost.sight.enemies.length>0&&e.energy==e.energy_capacity&&outpost.energy>700||outpost.sight.enemies.length>0&&memory[e.id]=="outpost_defender"?memory[e.id]="outpost_defender":(memory[e.id]=="outpost_defender"&&(memory[e.id]="outpost_harvesting"),e.energy>=20&&outpost.energy<1e3?memory[e.id]="outpost_charging":e.energy<20||e.energy<e.energy_capacity&&outpost.energy==outpost.energy_capacity?memory[e.id]="outpost_harvesting":e.energy==e.energy_capacity&&(memory[e.id]="outpost_do_nothing")),d-=1;else if(M)base.sight.enemies.length>0?memory[e.id]="base_defender":memory[e.id]=="base_pipe_1"?v-=1:memory[e.id]=="base_pipe_2"?z-=1:memory[e.id]=="base_pipe_3"?k-=1:v?(memory[e.id]="base_pipe_1",v-=1):z?(memory[e.id]="base_pipe_2",z-=1):k?(memory[e.id]="base_pipe_3",k-=1):memory[e.id]="base_pipe_1",M-=1;else if(memory[e.id]=="harvest_attacker")e.energy==e.energy_capacity&&(memory[e.id]="attacker");else{if(memory[e.id]=="attacker")continue;base.sight.enemies.length>0?memory[e.id]="base_defender":memory[e.id]="base_wait"}if(spirits_pipe_1=my_spirits.filter(e=>e.hp==1).filter(e=>memory[e.id]=="base_pipe_1"),spirits_pipe_2=my_spirits.filter(e=>e.hp==1).filter(e=>memory[e.id]=="base_pipe_2"),spirits_waiting=my_spirits.filter(e=>e.hp==1).filter(e=>memory[e.id]=="base_wait"),spirits_waiting.length>=B)for(let e of spirits_waiting)memory[e.id]="attacker";for(let e of friendly_spirits)if(memory[e.id]=="harasser"){let s=e.sight.enemies.length,p=!1;if(s>0){let P=q(e.sight.enemies),y=h(e.sight.enemies,e.position),c=r(e.position,y.position);c<=41e3?(e.move(y.position),e.energize(y)):P>=e.energy/2&&c<9e4?p=!0:c>4e4&&e.energy>y.energy?(e.move(y.position),e.energize(y)):c>41e3&&e.energy<=y.energy&&(p=!0),p&&(e.shout("RUN!"),e.move(l(e.position,y.position,400)),p=!1)}else e.shout("Blocking Spawn!"),e.move(O)}else if(memory[e.id]=="outpost_defender"){e.shout("Defend Outpost!");let s=h(outpost.sight.enemies,e.position);if(r(e.position,s.position)>4e4){e.move(s.position);continue}e.energize(s)}else if(memory[e.id]=="outpost_charging")e.shout("Outpost!"),e.move(o),e.energize(outpost),outpost.energy+=e.size;else if(memory[e.id]=="outpost_harvesting")e.shout("Outpost!"),e.move(o),e.energize(e);else if(memory[e.id]=="outpost_do_nothing")e.shout("I'm Bored!"),e.move(o);else if(memory[e.id]=="base_defender"){e.shout("Defend Base!");let s=h(base.sight.enemies,e.position);if(r(e.position,s.position)>4e4){e.move(s.position);continue}e.energize(s)}else if(memory[e.id]=="base_wait")e.shout("Wait!"),e.move(g);else if(memory[e.id]=="base_pipe_1")e.shout("Pipe 1!"),e.move(_),e.energy>20&&e.energize(base);else if(memory[e.id]=="base_pipe_2"){if(e.shout("Pipe 2!"),e.move(n),e.energy>20){let s=A(spirits_pipe_1,"base_pipe_1");e.energize(s),s.energy+=e.size}}else if(memory[e.id]=="base_pipe_3")if(e.shout("Pipe 3!"),e.move(m),e.energy>20){let s=A(spirits_pipe_2,"base_pipe_2");e.energize(s),s.energy+=e.size}else e.energize(e);else if(memory[e.id]=="attacker")if(t!="saltAxAtlas"&&t!=""){e.move(outpost.position);let s=w(enemy_spirits,e.position),p=r(e.position,s.position);e.energy==0&&p>7e4?memory[e.id]="harvest_attacker":e.energy<5&&p<25600?(e.move(s.position),e.explode()):p<4e4?(e.move(s.position),e.energize(s)):r(e.position,outpost.position)<4e4&&e.energize(outpost)}else{e.move(enemy_base.position);let s=w(enemy_spirits,e.position),p=r(e.position,s.position);e.energy==0&&p>7e4?memory[e.id]="harvest_attacker":e.energy<5&&p<25600?(e.move(s.position),e.explode()):p<4e4?(e.move(s.position),e.energize(s)):r(e.position,enemy_base.position)<4e4&&e.energize(enemy_base)}else memory[e.id]=="harvest_attacker"&&(e.move(N),e.energize(e))}else if(b==1){ready_spirits=friendly_spirits.filter(a=>a.energy==a.energy_capacity).length;for(unit of friendly_spirits)if(unit.energy==unit.energy_capacity&&ready_spirits==i?memory[unit.id]="attacking":memory[unit.id]!="attacking"&&(memory[unit.id]="harvesting"),memory[unit.id]=="attacking"){if(unit.shout("NUKE!"),4e4<r(unit.position,enemy_base.position)){unit.move(enemy_base.position);continue}unit.energize(enemy_base)}else if(memory[unit.id]=="harvesting"){if(unit.shout("Charging!"),t=="saltAxAtlas"||t=="")unit.move(o);else if(4e4<r(unit.position,memory.base_star.position)){unit.move(memory.base_star.position);continue}if(unit.energy==unit.energy_capacity)continue;unit.energize(unit)}}else for(unit of friendly_spirits)unit.shout("WTF! 0 or 1!")}})();
