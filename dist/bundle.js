(()=>{var u=Math.pow;function r(i,t){return u(i[0]-t[0],2)+u(i[1]-t[1],2)}function E(i,t){return[i[0]-t[0],i[1]-t[1]]}function I(i,t){return[i[0]/t,i[1]/t]}function y(i,t,o){let _=E(i,t),n=Math.sqrt(u(_[0],2)+u(_[1],2)),l=I(_,n),g=[Math.floor(l[0]*o),Math.floor(l[1]*o)];return[g[0]+t[0],g[1]+t[1]]}function h(i,t){let o=r(spirits[i[0]].position,t),_=spirits[i[0]];for(let n of i){let l=r(spirits[n].position,t);l<o&&(o=l,_=spirits[n])}return _}function v(i,t){let o=r(i[0].position,t),_=i[0];for(let n of i){let l=r(n.position,t);l<o&&(o=l,_=n)}return _}function z(i,t){let o=1e3,_="NONE";for(let n of i)n.energy<o&&n.energy<n.energy_capacity&&memory[n.id]==t&&(o=n.energy,_=n);return _}function B(i){let t=0;for(let o of i)t+=spirits[o].energy;return t}{r(base.position,star_zxq.position)<r(base.position,star_a1c.position)?(memory.base_star=star_zxq,memory.enemy_star=star_a1c):(memory.base_star=star_a1c,memory.enemy_star=star_zxq),all_spirits=[];for(x of Object.keys(spirits))all_spirits.push(spirits[x]);enemy_spirits=all_spirits.filter(a=>a.hp==1).filter(a=>a.player_id!="saltAxAtlas"),friendly_spirits=all_spirits.filter(a=>a.hp==1).filter(a=>a.player_id=="saltAxAtlas");let i=friendly_spirits.length,t=outpost.control,o=y(outpost.position,star_p89.position,199),_=y(memory.base_star.position,base.position,190),n=y(memory.base_star.position,_,180),l=y(memory.base_star.position,n,150),g=y(outpost.position,base.position,70),P=y(star_p89.position,enemy_base.position,300),b=0;if(enemy_spirits.length==0&&(b=1),b==0){let a=1,d=2,k=9,A=5;t!="saltAxAtlas"&&t!=""&&(a=0,d=0);let f=Math.floor((i-a-d)/3);f>3&&(f=3);let M=f,q=f,w=f;for(let e of friendly_spirits)a?(memory[e.id]=="outpost_harvesting"&&e.energy!=e.energy_capacity?memory[e.id]="outpost_harvesting":e.energy>10?memory[e.id]="harasser":memory[e.id]="outpost_harvesting",a-=1):d?((memory[e.id]=="base_defender"||memory[e.id]=="base_charging"||memory[e.id]=="base_harvesting")&&(memory[e.id]="outpost_harvesting"),outpost.sight.enemies.length>0&&e.energy==e.energy_capacity&&outpost.energy>700||outpost.sight.enemies.length>0&&memory[e.id]=="outpost_defender"?memory[e.id]="outpost_defender":(memory[e.id]=="outpost_defender"&&(memory[e.id]="outpost_harvesting"),e.energy>=20&&outpost.energy<1e3?memory[e.id]="outpost_charging":e.energy<20||e.energy<e.energy_capacity&&outpost.energy==outpost.energy_capacity?memory[e.id]="outpost_harvesting":e.energy==e.energy_capacity&&(memory[e.id]="outpost_do_nothing")),d-=1):k?(base.sight.enemies.length>0?memory[e.id]="base_defender":M?(memory[e.id]="base_pipe_1",M-=1):q?(memory[e.id]="base_pipe_2",q-=1):w&&(memory[e.id]="base_pipe_3",w-=1),k-=1):A?(base.sight.enemies.length>0?memory[e.id]="base_defender":memory[e.id]="base_def",A-=1):memory[e.id]="attacker";let O=my_spirits.filter(e=>e.hp==1).filter(e=>memory[e.id]=="base_pipe_1"),N=my_spirits.filter(e=>e.hp==1).filter(e=>memory[e.id]=="base_pipe_2");console.log(O.length),console.log(N.length);for(let e of friendly_spirits){if(memory[e.id]=="harasser"){let s=e.sight.enemies.length,p=!1;if(s>0){let D=B(e.sight.enemies),m=h(e.sight.enemies,e.position),c=r(e.position,m.position);c<=41e3?(e.move(m.position),e.energize(m)):D>=e.energy/2&&c<9e4?p=!0:c>4e4&&e.energy>m.energy?(e.move(m.position),e.energize(m)):c>41e3&&e.energy<=m.energy&&(p=!0),p&&(e.shout("RUN!"),e.move(y(e.position,m.position,400)),p=!1)}else e.shout("Blocking Spawn!"),e.move(P)}else if(memory[e.id]=="outpost_defender"){e.shout("Defend Outpost!");let s=h(outpost.sight.enemies,e.position);if(r(e.position,s.position)>4e4){e.move(s.position);continue}e.energize(s)}else if(memory[e.id]=="outpost_charging")e.shout("Outpost!"),e.move(o),e.energize(outpost),outpost.energy+=e.size;else if(memory[e.id]=="outpost_harvesting")e.shout("Outpost!"),e.move(o),e.energize(e);else if(memory[e.id]=="outpost_do_nothing")e.shout("I'm Bored!"),e.move(o);else if(memory[e.id]=="base_defender"){e.shout("Defend Base!");let s=h(base.sight.enemies,e.position);if(r(e.position,s.position)>4e4){e.move(s.position);continue}e.energize(s)}else if(memory[e.id]=="base_def")e.shout("Idle!"),e.move(g);else if(memory[e.id]=="base_pipe_1")e.shout("Pipe 1!"),e.move(_),e.energy>20&&e.energize(base);else if(memory[e.id]=="base_pipe_2"){if(e.shout("Pipe 2!"),e.move(n),e.energy>20){let s=z(O,"base_pipe_1");e.energize(s),s.energy+=e.size}}else if(memory[e.id]=="base_pipe_3")if(e.shout("Pipe 3!"),e.move(l),e.energy>20){let s=z(N,"base_pipe_2");e.energize(s),s.energy+=e.size}else e.energize(e);else if(memory[e.id]=="attacker")if(t!="saltAxAtlas"&&t!=""){e.move(outpost.position);let s=v(enemy_spirits,e.position);r(e.position,s.position)<4e4?e.energize(s):r(e.position,outpost.position)<4e4&&e.energize(outpost)}else{e.move(enemy_base.position);let s=v(enemy_spirits,e.position);r(e.position,s.position)<4e4?e.energize(s):r(e.position,enemy_base.position)<4e4&&e.energize(enemy_base)}console.log(e.last_energized)}}else if(b==1){ready_spirits=friendly_spirits.filter(a=>a.energy==a.energy_capacity).length;for(unit of friendly_spirits)if(unit.energy==unit.energy_capacity&&ready_spirits==i?memory[unit.id]="attacking":memory[unit.id]!="attacking"&&(memory[unit.id]="harvesting"),memory[unit.id]=="attacking"){if(unit.shout("NUKE!"),4e4<r(unit.position,enemy_base.position)){unit.move(enemy_base.position);continue}unit.energize(enemy_base)}else if(memory[unit.id]=="harvesting"){if(unit.shout("Charging!"),t=="saltAxAtlas"||t=="")unit.move(o);else if(4e4<r(unit.position,memory.base_star.position)){unit.move(memory.base_star.position);continue}if(unit.energy==unit.energy_capacity)continue;unit.energize(unit)}}else for(unit of friendly_spirits)unit.shout("WTF! 0 or 1!")}})();
